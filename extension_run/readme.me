# Soft Group Masking Extension - Evaluation

## Overview

This folder contains the evaluation notebook and results for the **Soft Group Masking** extension applied to [Chronos-2](https://github.com/amazon-science/chronos-forecasting).

The extension replaces the binary (hard) group attention mask in Chronos-2 with a continuous (soft) mask based on Pearson correlation similarity between time series in the same batch. This allows partial cross-series attention weighted by how similar the series are.

## How to Run

1. Open `chron_2_bench.ipynb` in **Google Colab** (GPU runtime recommended).
2. Run all cells sequentially.

The notebook will:
- Clone the modified Chronos repository (`soft_attention_2` branch) and install it.
- Load the pretrained `amazon/chronos-2` model.
- Load the 27 zero-shot benchmark datasets defined in `scripts/evaluation/configs/zero-shot.yaml`.
- For each dataset, generate forecasts using both **baseline** (hard group masking) and **soft group masking** (Pearson correlation, temperature=5.0).
- Evaluate using MASE and WQL metrics via GluonTS.
- Optionally save results to a Google Sheet in real time.
- Run a paired t-test and compute Cohen's d effect size at the end.

No additional configuration is needed. The notebook uses the source code from the repository directly.

## Test Set

The evaluation uses the **Chronos Benchmark II** zero-shot test set (27 datasets not seen during training), including:

monash_traffic, monash_australian_electricity, ercot, ETTm, ETTh, exchange_rate, nn5, monash_nn5_weekly, monash_weather, monash_covid_deaths, monash_fred_md, m4_quarterly, m4_yearly, dominick, m5, monash_tourism_monthly, monash_tourism_quarterly, monash_tourism_yearly, monash_car_parts, monash_hospital, monash_cif_2016, monash_m1_yearly, monash_m1_quarterly, monash_m1_monthly, monash_m3_monthly, monash_m3_yearly, monash_m3_quarterly

## Results

Results are saved in `Chronos Benchmark II - Sheet1.csv`. Each row contains the dataset name, mode (hard/soft), MASE, WQL, and the difference between baseline and soft masking.

## Requirements

- Google Colab with GPU runtime (or a local environment with CUDA)
- Python 3.10+
- Dependencies are installed automatically by the notebook
